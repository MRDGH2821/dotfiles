{{- /* Soar Declarative Package Configuration */ -}}
{{- /* Run `soar apply` to install packages defined here. */ -}}
{{- /*  Run `soar apply --prune` to also remove packages not listed. */ -}}
{{- /*  Package format: */ -}}
{{- /*    package_name = "*"                    # Latest version */ -}}
{{- /*    package_name = "1.2.3"                # Specific version (pinned) */ -}}
{{- /*    package_name = { version = "1.2" }    # Same as above */ -}}
{{- /*    package_name = { pkg_id = "pkg-bin", repo = "bincache" } */ -}}
{{- /*    package_name = { pinned = true, portable = { home = "~/.pkg" } } */ -}}

{{- $distros := include ".chezmoidata/distros.yaml" | fromYaml -}}
{{- $pkgs := include ".chezmoidata/packages/soar.toml" | fromToml -}}

{{- /*  Default settings applied to all packages unless overridden. */ -}}
{{- /*  Default settings for all packages. */ -}}
{{- println "[defaults]" -}}
{{- /*  Default profile to use for installations. */ -}}
{{- println "profile = \"default\"" -}}
{{- /*  Whether to install binary only (exclude logs, desktop files, etc). */ -}}
{{- println "binary_only = false" -}}

{{- /*  Map of package names to their specifications. */ -}}
{{- /*  Supports both simple string form (version) and detailed table form. */ -}}
{{- println "[packages.pcloud]" -}}
{{- print ( $pkgs.pcloud | toToml ) -}}

{{- println "[packages.rclone-browser]" -}}
{{- print ( $pkgs.rclone_browser | toToml ) -}}

{{- /* println "[packages.savestate]" */ -}}
{{- /* print ( $pkgs.savestate | toToml ) */ -}}

{{- println "[packages.use-via]" -}}
{{- print ( $pkgs.use_via | toToml ) -}}

{{- if eq .devicetype "laptop" -}}
  {{- println "[packages.pince]" -}}
  {{- print ( $pkgs.pince | toToml ) -}}
{{- end -}}

{{- if and (hasKey .chezmoi.osRelease "versionCodename") (has .chezmoi.osRelease.versionCodename $distros.debian_codes) -}}
  {{- println "[packages.ludusavi]" -}}
  {{- print ( $pkgs.ludusavi | toToml ) -}}
  {{- println "[packages.mcfly]" -}}
  {{- print ( $pkgs.mcfly | toToml ) -}}
  {{- println "[packages.tldr]" -}}
  {{- print ( $pkgs.tldr | toToml ) -}}
  {{- println "[packages.yq]" -}}
  {{- print ( $pkgs.yq | toToml ) -}}
{{- end -}}

{{ if and (hasKey .chezmoi.osRelease "id") (has .chezmoi.osRelease.id $distros.fedora) }}
  {{- println "[packages.dra]" -}}
  {{- print ($pkgs.dra | toToml ) -}}
  {{- println "[packages.ludusavi]" -}}
  {{- print ($pkgs.ludusavi | toToml ) -}}
  {{- println "[packages.mcfly]" -}}
  {{- print ($pkgs.mcfly | toToml ) -}}
{{- end -}}

{{ if and (hasKey .chezmoi.osRelease "ubuntuCodename") (has .chezmoi.osRelease.ubuntuCodename $distros.ubuntu_codes) }}
  {{- println "[packages.lazygit]" -}}
  {{- print ($pkgs.lazygit | toToml ) -}}
  {{- println "[packages.ludusavi]" -}}
  {{- print ($pkgs.ludusavi | toToml ) -}}
  {{- println "[packages.mcfly]" -}}
  {{- print ($pkgs.mcfly | toToml ) -}}
  {{- println "[packages.tldr]" -}}
  {{- print ($pkgs.tldr | toToml ) -}}
  {{- println "[packages.yq]" -}}
  {{- print ($pkgs.yq | toToml ) -}}
{{- end -}}
